---
import Base from '../layouts/Base.astro';
import Hero from '../components/sections/Hero.astro';
import ServicesGrid from '../components/sections/ServicesGrid.astro';
import Features from '../components/sections/Features.astro';
import CTA from '../components/sections/CTA.astro';
import { generateLocalBusinessSchema } from '../lib/structured-data/LocalBusiness';
import { generateBreadcrumbSchema } from '../lib/structured-data/Breadcrumbs';
import settings from '../content/settings.json';
import services from '../content/services.json';

const pageTitle = settings.seo?.defaultTitle || `${settings.title} | Professional Lawn Care & Landscaping`;
const pageDescription = settings.description;

// Structured data for homepage
const siteUrl = settings.siteUrl;
const localBusinessSchema = generateLocalBusinessSchema(settings, undefined, siteUrl);
const breadcrumbSchema = generateBreadcrumbSchema(
  [{ name: 'Home', url: '/' }],
  siteUrl
);

const structuredData = {
  '@graph': [localBusinessSchema, breadcrumbSchema],
};

// Get primary services for the grid
const primaryServices = services.filter(s => s.isPrimary);
---

<Base 
  title={pageTitle} 
  description={pageDescription} 
  structuredData={structuredData}
>
  <!-- Hero Section -->
  <Hero
    headline="Love Your Lawn Without the Work"
    subheadline="Professional lawn care and landscaping for Cape May County homeowners. Licensed, insured, and satisfaction guaranteed."
    ctaLabel="Get a Free Quote"
    ctaLink="/contact"
    secondaryCtaLabel="View Services"
    secondaryCtaLink="/services"
    image="/images/hero-lawn.jpg"
  />

  <!-- Services Grid -->
  <ServicesGrid 
    heading="Our Services"
    subheading="From routine lawn care to custom landscape design, we have you covered."
    services={primaryServices}
    showAll={true}
  />

  <!-- Why Choose Us Features -->
  <Features
    heading="Why Choose Blue Lawns?"
    subheading="We're your neighbors, and we treat your property like our own."
    items={[
      {
        title: "Licensed & Insured",
        description: "Fully licensed and insured for your peace of mind. We take responsibility for our work.",
        icon: "âœ“"
      },
      {
        title: "Local Experts",
        description: "We know Cape May County. Our team understands coastal conditions and what your lawn needs.",
        icon: "ðŸ "
      },
      {
        title: "Satisfaction Guaranteed",
        description: "Not happy? We'll make it right. Your satisfaction is our top priority.",
        icon: "â­"
      },
      {
        title: "Reliable Service",
        description: "Show up on time, every time. You can count on us to be there when we say we will.",
        icon: "ðŸ•"
      }
    ]}
  />

  <!-- CTA Section -->
  <CTA
    heading="Ready for a Beautiful Lawn?"
    body="Get your free estimate today. We'll assess your property and provide a customized plan."
    buttonLabel="Request a Quote"
    buttonLink="/contact"
    secondaryButtonLabel="Call Now"
    secondaryButtonLink="tel:609-425-2954"
  />
</Base>
