---
import Base from '../../layouts/Base.astro';
import Container from '../../components/layout/Container.astro';
import Hero from '../../components/sections/Hero.astro';
import LocationServiceCard from '../../components/LocationServiceCard.astro';
import CTA from '../../components/sections/CTA.astro';
import { generateBreadcrumbSchema } from '../../lib/structured-data/Breadcrumbs';
import { generateLocalBusinessSchema } from '../../lib/structured-data/LocalBusiness';
import settings from '../../content/settings.json';
import services from '../../content/services.json';
import locations from '../../content/locations.json';

const location = locations.find(l => l.slug === 'wildwood')!;
const title = `Landscaping in ${location.town}, NJ | ${settings.title}`;
const description = `Professional lawn care and landscaping services in ${location.town}, NJ. ${location.description} Get a free quote today.`;

const siteUrl = settings.siteUrl;
const breadcrumbSchema = generateBreadcrumbSchema(
  [
    { name: 'Home', url: '/' },
    { name: 'Service Areas', url: '/locations' },
    { name: location.town, url: `/locations/${location.slug}` },
  ],
  siteUrl
);
const localBusinessSchema = generateLocalBusinessSchema(settings, location, siteUrl);

const structuredData = {
  '@graph': [breadcrumbSchema, localBusinessSchema],
};

const primaryServices = services.filter(s => s.type === 'primary');
---

<Base 
  title={title} 
  description={description}
  structuredData={structuredData}
>
  <Hero
    variant="simple"
    title={`Lawn Care in ${location.town}`}
    subtitle={`Professional landscaping and lawn maintenance services for ${location.town}, NJ. Licensed, insured, and satisfaction guaranteed.`}
    primaryCta={{ label: "Get a Free Quote", href: "/contact" }}
    backgroundImage={location.heroImage}
    alignment="center"
  />

  <section class="py-section-mobile lg:py-section-desktop bg-background">
    <Container>
      <div class="max-w-3xl mx-auto text-center mb-12">
        <h2 class="font-display text-3xl font-bold mb-6 text-brand-navy">Serving {location.town}, NJ</h2>
        <p class="text-lg text-slate-600">{location.description}</p>
      </div>
    </Container>
  </section>

  <section class="py-section-mobile lg:py-section-desktop bg-white">
    <Container>
      <h2 class="font-display text-3xl font-bold mb-12 text-center text-brand-navy">Our Services in {location.town}</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {primaryServices.map((service) => (
          <LocationServiceCard 
            service={service} 
            locationSlug={location.slug}
            locationTown={location.town}
          />
        ))}
      </div>
    </Container>
  </section>

  <CTA
    title={`Ready to Get Started in ${location.town}?`}
    text="Contact us today for a free estimate. We're proud to serve the residents of this beautiful coastal community."
    primaryCtaLabel="Contact Us"
    primaryCtaLink="/contact"
    secondaryCtaLabel="Call Now"
    secondaryCtaLink={`tel:${settings.contact?.phone.replace(/\s/g, '')}`}
  />
</Base>
