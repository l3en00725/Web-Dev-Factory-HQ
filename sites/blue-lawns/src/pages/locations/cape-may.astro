---
import Base from '../../layouts/Base.astro';
import Container from '../../components/layout/Container.astro';
import Hero from '../../components/sections/Hero.astro';
import LocationServiceCard from '../../components/LocationServiceCard.astro';
import CTA from '../../components/sections/CTA.astro';
import { generateBreadcrumbSchema } from '../../lib/structured-data/Breadcrumbs';
import { generateLocalBusinessSchema } from '../../lib/structured-data/LocalBusiness';
import settings from '../../content/settings.json';
import services from '../../content/services.json';
import locations from '../../content/locations.json';

const location = locations.find(l => l.slug === 'cape-may')!;
const title = `Landscaping in ${location.town}, NJ | ${settings.title}`;
const description = `Professional lawn care and landscaping services in ${location.town}, NJ. ${location.description} Get a free quote today.`;

const siteUrl = settings.siteUrl;
const breadcrumbSchema = generateBreadcrumbSchema(
  [
    { name: 'Home', url: '/' },
    { name: 'Service Areas', url: '/locations' },
    { name: location.town, url: `/locations/${location.slug}` },
  ],
  siteUrl
);
const localBusinessSchema = generateLocalBusinessSchema(settings, location, siteUrl);

const structuredData = {
  '@graph': [breadcrumbSchema, localBusinessSchema],
};

const primaryServices = services.filter(s => s.type === 'primary');
---

<Base 
  title={title} 
  description={description}
  structuredData={structuredData}
>
  <Hero
    variant="simple"
    title={`Professional Landscaping & Property Care in ${location.town}`}
    subtitle={`Trusted local experts serving ${location.town} with comprehensive lawn care, landscaping, and property maintenance services.`}
    primaryCta={{ label: "Get a Free Quote", href: "/contact" }}
    backgroundImage={location.heroImage}
    alignment="center"
  />

  <section class="py-section-mobile lg:py-section-desktop bg-background">
    <Container>
      <div class="max-w-3xl mx-auto">
        <h2 class="font-display text-3xl font-bold mb-6 text-brand-navy">Your Trusted Landscaping Partner in {location.town}</h2>
        
        <p class="text-lg text-slate-600 mb-6">
          Blue Lawns has been the go-to landscaping company for {location.town} homeowners and businesses since 2010. We understand the unique challenges of maintaining beautiful outdoor spaces in Cape May County's coastal environment, from salt air exposure to sandy soils and seasonal weather patterns.
        </p>

        <p class="text-lg text-slate-600 mb-6">
          Our team of licensed professionals brings local expertise and obsessive attention to detail to every project. Whether you need weekly lawn maintenance, custom landscape design, or seasonal cleanup services, we deliver reliable, high-quality results that enhance your property's curb appeal and value.
        </p>

        <p class="text-lg text-slate-600 mb-8">
          {location.town} homeowners trust Blue Lawns because we show up on time, communicate clearly, and treat every property like it's our own. We're fully licensed and insured, and we stand behind our work with a satisfaction guarantee. Let us handle the hard work so you can enjoy your weekends and a beautiful outdoor space year-round.
        </p>

        <div class="bg-primary-50 border-l-4 border-primary-500 p-6">
          <p class="text-slate-700 font-medium">
            <strong>Local Expertise:</strong> {location.description}
          </p>
        </div>
      </div>
    </Container>
  </section>

  <section class="py-section-mobile lg:py-section-desktop bg-white">
    <Container>
      <h2 class="font-display text-3xl font-bold mb-12 text-center text-brand-navy">Our Services in {location.town}</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {primaryServices.map((service) => (
          <LocationServiceCard 
            service={service} 
            locationSlug={location.slug}
            locationTown={location.town}
          />
        ))}
      </div>
    </Container>
  </section>

  <CTA
    title={`Ready to Get Started in ${location.town}?`}
    text="Contact us today for a free estimate. We're proud to serve the residents of this beautiful coastal community."
    primaryCtaLabel="Contact Us"
    primaryCtaLink="/contact"
    secondaryCtaLabel="Call Now"
    secondaryCtaLink={`tel:${settings.contact?.phone.replace(/\s/g, '')}`}
  />
</Base>
