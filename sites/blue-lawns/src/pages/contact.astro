---
import Base from '../layouts/Base.astro';
import Container from '../components/layout/Container.astro';
import ContactSection from '../components/sections/ContactSection.astro';
import { generateLocalBusinessSchema } from '../lib/structured-data/LocalBusiness';
import { generateBreadcrumbSchema } from '../lib/structured-data/Breadcrumbs';
import settings from '../content/settings.json';

const title = `Contact Us | ${settings.title}`;
const description = "Request a free landscaping estimate in Cape May County. Call 609-425-2954 or fill out our contact form. Licensed, insured, and satisfaction guaranteed.";

// Structured data
const siteUrl = settings.siteUrl;
const localBusinessSchema = generateLocalBusinessSchema(settings, undefined, siteUrl);
const breadcrumbSchema = generateBreadcrumbSchema(
  [
    { name: 'Home', url: '/' },
    { name: 'Contact', url: '/contact' },
  ],
  siteUrl
);

const structuredData = {
  '@graph': [localBusinessSchema, breadcrumbSchema],
};
---

<Base 
  title={title} 
  description={description}
  structuredData={structuredData}
  headerVariant="solid"
>
  {/* Google Places API only on contact page */}
  {import.meta.env.PUBLIC_GOOGLE_PLACES_API_KEY && (
    <script 
      slot="head"
      src={`https://maps.googleapis.com/maps/api/js?key=${import.meta.env.PUBLIC_GOOGLE_PLACES_API_KEY}&libraries=places&loading=async`}
      async
      defer
    ></script>
  )}
  
  <section class="bg-background py-section-mobile lg:py-section-desktop">
    <Container size="lg">
      <div class="text-center mb-12">
        <h1 class="font-display text-4xl font-bold lg:text-5xl mb-4">{title}</h1>
        <p class="text-xl text-foreground-secondary max-w-2xl mx-auto">{description}</p>
      </div>
      
      <ContactSection 
        heading="Get In Touch"
        subheading="Fill out the form below and we'll get back to you as soon as possible."
        showForm={true}
        showContactInfo={true}
        layout="form-left"
        contactEmail={settings.contact.email}
        contactPhone={settings.contact.phone}
      />
    </Container>
  </section>
</Base>
