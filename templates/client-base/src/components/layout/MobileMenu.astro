---
import Button from '../ui/Button.astro';

interface Props {
  items: { title: string; href: string; active?: boolean }[];
}

const { items } = Astro.props;
---

<div 
  id="mobile-menu" 
  class="fixed inset-0 z-50 translate-x-full bg-background/95 backdrop-blur-md transition-transform duration-normal lg:hidden"
  aria-hidden="true"
>
  <div class="flex h-full flex-col p-6">
    <div class="flex justify-end">
      <Button variant="ghost" size="sm" id="close-menu" aria-label="Close Menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
      </Button>
    </div>
    
    <nav class="mt-8 flex flex-col gap-4 text-center">
      {items.map((item) => (
        <a 
          href={item.href} 
          class:list={[
            "text-2xl font-medium transition-colors hover:text-primary",
            item.active ? "text-primary" : "text-foreground"
          ]}
        >
          {item.title}
        </a>
      ))}
    </nav>
  </div>
</div>

<script>
  const menu = document.getElementById('mobile-menu');
  const closeBtn = document.getElementById('close-menu');
  
  // Toggle logic is driven by custom event 'toggle-menu' dispatched from Header
  document.addEventListener('toggle-menu', () => {
    const isOpen = menu?.getAttribute('aria-hidden') === 'false';
    if (menu) {
      menu.setAttribute('aria-hidden', (!isOpen).toString());
      if (!isOpen) {
        menu.classList.remove('translate-x-full');
        document.body.style.overflow = 'hidden'; // Prevent scroll
      } else {
        menu.classList.add('translate-x-full');
        document.body.style.overflow = '';
      }
    }
  });

  closeBtn?.addEventListener('click', () => {
    document.dispatchEvent(new CustomEvent('toggle-menu'));
  });
</script>

