---
import Container from '../layout/Container.astro';
import Image from '../sanity/Image.astro';

type GridColumnCount = 1 | 2 | 3 | 4 | 6;

interface GalleryImage {
  asset?: any;
  image?: any;
  alt?: string;
  caption?: string;
  category?: string;
  title?: string;
}

interface Props {
  heading?: string;
  subheading?: string;
  images?: GalleryImage[];
  layout?: 'grid' | 'masonry' | 'carousel';
  columns?: GridColumnCount;
  enableLightbox?: boolean;
  enableFiltering?: boolean;
}

const { 
  heading, 
  subheading, 
  images = [], 
  layout = 'grid', 
  columns = 3 
} = Astro.props;

const gridCols: Record<GridColumnCount, string> = {
  1: 'columns-1',
  2: 'sm:columns-2',
  3: 'sm:columns-2 lg:columns-3',
  4: 'sm:columns-2 lg:columns-4',
  6: 'sm:columns-3 lg:columns-6'
};
---

<section class="py-section-mobile lg:py-section-desktop bg-background">
  <Container>
    {(heading || subheading) && (
      <div class="mb-section-gap-mobile lg:mb-section-gap text-center">
        {heading && <h2 class="font-display text-3xl font-bold lg:text-4xl">{heading}</h2>}
        {subheading && <p class="mt-4 text-foreground-secondary">{subheading}</p>}
      </div>
    )}

    {/* Simple masonry grid implementation for now */}
    <div class={`columns-1 gap-6 space-y-6 ${gridCols[columns] || 'lg:columns-3'}`}>
      {images.map((img) => (
        <div class="break-inside-avoid overflow-hidden rounded-xl shadow-md transition-all duration-normal hover:scale-[1.02] hover:shadow-lg group">
          <Image 
            asset={img.image || img.asset}
            alt={img.alt || img.title || "Gallery image"} 
            class="h-auto w-full object-cover transition-transform duration-slow group-hover:scale-105" 
          />
          {img.caption && (
            <div class="bg-surface p-3 text-xs text-center text-foreground-secondary border-t border-border-subtle">
              {img.caption}
            </div>
          )}
        </div>
      ))}
    </div>
  </Container>
</section>
