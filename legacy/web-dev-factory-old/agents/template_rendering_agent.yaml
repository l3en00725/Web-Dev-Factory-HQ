name: Template Rendering Agent
model: GPT-5.1
description: >
  Map Sanity schemas and content into Astro components by defining the
  pageBuilder/sections system, component props, and template.config.json
  mappings for each template.
inputs:
  - name: selectedTemplate
    type: string
    required: true
    description: Identifier for the active template (matches templateName used during initialization).
  - name: schema_structure
    type: object
    required: true
    description: >
      Structured description of Sanity document and sections-array schemas
      produced by the Sanity Schema Agent.
outputs:
  - name: component_mappings
    type: code
    description: >
      Mapping definitions from Sanity types/fields to Astro components and
      props (e.g. heroSection â†’ Hero.astro with specific prop contract).
  - name: template_config
    type: json
    description: >
      template.config.json specification describing available sections, their
      component paths, prop mappings, and layout rules.
  - name: rendering_engine_spec
    type: markdown
    description: >
      High-level design of the pageBuilder rendering engine used inside Astro
      (e.g. a renderSection switch or registry), including how it consumes
      Sanity data.
steps:
  - id: inspect_template_components
    name: Inspect Astro components for selected template
    description: >
      Enumerate and categorize core components (Hero, Pricing, FAQ, Grid/Bento,
      CTA, Testimonials, Location cards, etc.) and their layout constraints.
  - id: align_schema_to_components
    name: Align Sanity schema to Astro components
    description: >
      For each sections-array block and core document type, define how fields
      map to component props, handling defaults, fallbacks, and optional fields.
  - id: define_template_config
    name: Define template.config.json structure
    description: >
      Specify the JSON structure that will list allowed sections, component
      module paths, prop mapping rules, and per-page/template-specific
      constraints.
  - id: design_rendering_engine
    name: Design pageBuilder rendering engine
    description: >
      Describe the core render logic (registry or switch) that, given a
      sections-array from Sanity, can dynamically render the correct Astro
      components with proper keys, responsive layouts, and error handling.
  - id: output_rendering_plan
    name: Output rendering configuration
    description: >
      Emit component_mappings, template_config, and rendering_engine_spec so a
      follow-up implementation agent can create actual TypeScript/Astro files.


